<!DOCTYPE html>
<html lang = "ja">
<head>
    <meta charset = "utf-8">
    <title>Chatapp</title>

    <style>
        .name {
            font-size: 10px;
        }
        .text {
            font-size: 16px;
        }
    </style>
</head>
<body>

<div>
    <div>
        <input type="text" id="username">
    </div>
    <div>
        <textarea id="text" rows="5"></textarea>
        <button id="send">send</button>
    </div>
    <div id="output"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/5.11.1/firebase.js"></script>
<script>
    // Initialize Firebase
    var config = {
        apiKey: "AIzaSyADnRigoK2ox_lX1kwMkZXcsoGvVw5yGZw",
        authDomain: "learning-web-31836.firebaseapp.com",
        databaseURL: "https://learning-web-31836.firebaseio.com",
        projectId: "learning-web-31836",
        storageBucket: "learning-web-31836.appspot.com",
        messagingSenderId: "378015738992"
    };
    firebase.initializeApp(config);
    
    // Mag送信準備
    const newPostRef = firebase.database();
    let room = "room1";

    const send = document.getElementById("send");
    const username = document.getElementById("username");
    const text = document.getElementById("text");
    const output = document.getElementById("output");

    // Msg送信処理
    send.addEventListener('click', () => {
        newPostRef.ref(room).push({
            username: username.value,
            text: text.value,
        });
        text.value = "";
    });

    // Msg受信処理
    newPostRef.ref(room).on("child_added", (data) => {
        const val = data.val();
        const key = data.key;
        let str = "";
        
        str += '<div class="name">' + val.username + '</div>';
        str += '<div class="text">' + val.text + '</div>';

        output.innerHTML += str;  
    });
</script>
</body>
</html>